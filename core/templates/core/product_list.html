{% extends "core/base.html" %}
{% block title %}Genuine Products â€” CounterfeitCheck{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />

<style>
  .material-symbols-outlined {
    font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
  }

  section { color: var(--text-color); }

  .product-card {
    background: var(--card-bg);
    border: 3px solid var(--border-color);
    border-radius: 0.75rem;
    box-shadow: 6px 6px 0 var(--border-color);
    padding: 1.25rem;
    transition: all 0.25s ease;
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .product-card:hover {
    transform: translate(-4px, -4px);
    box-shadow: 8px 8px 0 var(--border-color);
  }

  .product-image-container {
    position: relative;
    width: 100%;
    height: 240px;
    border-radius: 0.75rem;
    border: 2px solid var(--border-color);
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-color);
  }

  .product-image { width: 100%; height: 100%; object-fit: contain; }

  .genuine-badge {
    position: absolute;
    top: 12px; right: 12px;
    background: var(--btn-bg);
    color: var(--btn-text);
    padding: 0.3rem 0.65rem;
    font-size: 0.7rem;
    border-radius: 6px;
    border: 2px solid var(--border-color);
    text-transform: uppercase;
    font-weight: 700;
    box-shadow: 2px 2px 0 var(--border-color);
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }

  .filter-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.75rem;
    margin-bottom: 2rem;
  }

  .filter-btn {
    background: var(--card-bg);
    border: 3px solid var(--border-color);
    color: var(--text-color);
    padding: 0.5rem 1.25rem;
    border-radius: 0.5rem;
    box-shadow: 4px 4px 0 var(--border-color);
    font-weight: 700;
    transition: all .2s ease;
  }

  .filter-btn.active,
  .filter-btn:hover {
    transform: translate(-2px, -2px);
    background: var(--btn-bg);
    color: var(--btn-text);
    box-shadow: 6px 6px 0 var(--border-color);
  }
</style>
{% endblock %}

{% block content %}
<section class="max-w-7xl mx-auto">

  <div class="text-center mb-12">
    <div class="flex justify-center items-center gap-3 mb-4">
      <span class="material-symbols-outlined text-2xl md:text-3xl ">verified</span>
      <h2 class="text-2xl md:text-3xl font-extrabold">Genuine Products</h2>
    </div>
    <p class=" max-w-2xl mx-auto">
      Browse all verified authentic products registered by trusted manufacturers.
    </p>
  </div>

  <!-- Filter Buttons -->
  <div class="filter-buttons">
    <button class="filter-btn active" data-filter="all">All Products</button>
    <button class="filter-btn" data-filter="electronics">Electronics</button>
    <button class="filter-btn" data-filter="fashion">Fashion</button>
    <button class="filter-btn" data-filter="pharma">Pharmaceuticals</button>
    <button class="filter-btn" data-filter="luxury">Luxury Goods</button>
  </div>

  {% if products %}
  <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4" id="productsGrid">
    {% for product in products %}
    <div class="product-card" data-category="{{ product.category|default:'all' }}">

      <div class="product-image-container">
        {% if product.image %}
        <img src="{{ product.image.url }}" alt="{{ product.product_name }}" class="product-image" />
        {% else %}
        <span class="material-symbols-outlined text-6xl text-zinc-500">inventory_2</span>
        {% endif %}

        <div class="genuine-badge">
          <span class="material-symbols-outlined text-xs">verified</span> Genuine
        </div>

        {% if user.is_staff %}
        <div class="absolute top-3 left-3 flex flex-col gap-2">
          <a href="{% url 'edit_product' product.id %}" class="admin-btn bg-white text-black">
            <span class="material-symbols-outlined text-sm">edit</span>
          </a>
          <form method="POST" action="{% url 'delete_product' product.id %}" onsubmit="return confirm('Delete this product?');">
            {% csrf_token %}
            <button class="admin-btn bg-red-600 text-white">
              <span class="material-symbols-outlined text-sm">delete</span>
            </button>
          </form>
        </div>
        {% endif %}
      </div>

      <div class="product-info text-center mt-3">
        <h3 class="text-lg font-bold">{{ product.product_name }}</h3>
        <p class="text-sm opacity-70">{{ product.manufacturer }}</p>
      </div>
    </div>
    {% endfor %}
  </div>

  {% else %}
  <div class="neo-card text-center py-16">
    <span class="material-symbols-outlined text-8xl text-zinc-600 mb-4">inventory_2</span>
    <h3 class="text-2xl font-bold text-white mb-2">No Products Found</h3>
    <p class="text-zinc-400 mb-6">No registered authentic products yet.</p>
    {% if user.is_staff %}
    <a href="{% url 'add_product' %}" class="neo-btn neo-btn-primary flex items-center justify-center gap-2">
      <span class="material-symbols-outlined">add</span> Add Product
    </a>
    {% endif %}
  </div>
  {% endif %}
</section>
{% endblock %}
{% block extra_js %}
{{ block.super }}
<script>
  (function () {
    const filterButtons = document.querySelectorAll(".filter-btn");
    const productCards = document.querySelectorAll("#productsGrid .product-card");
    if (!filterButtons.length || !productCards.length) return;

    filterButtons.forEach((button) => {
      button.addEventListener("click", () => {
        const filter = button.dataset.filter || "all";
        filterButtons.forEach((btn) => btn.classList.remove("active"));
        button.classList.add("active");
        productCards.forEach((card) => {
          const cat = card.dataset.category || "all";
          card.style.display = (filter === "all" || cat === filter) ? "flex" : "none";
        });
      });
    });
  })();
</script>
{% endblock %}

